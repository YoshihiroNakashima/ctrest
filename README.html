<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h2 id="パッケージの概要">パッケージの概要</h2>
<p>　“ctrest”は，RESTモデルもしくはREST-RADモデルを簡単に利用するためのRパッケージです．REST/REST-RADモデルとは，自動撮影カメラ（カメラトラップ）によって得られた動画データに基づいて地上性哺乳類・鳥類の密度推定を行うための統計モデルです．RESTモデルの詳細について<a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2664.13059">Nakashima
et
al. (2018)</a>，REST-RADモデルについてはXXXXXXをご参照ください．また，データの準備までのプロセスについては，XXXを参照してください．</p>
<p>　パッケージは，以下のような関数を含みます．</p>
<ul>
<li><p><strong>データの前処理</strong>：必要なデータの前処理を行います．後で使う密度推定用の関数は，これらの関数を利用して前処理を行ったこと（もしくは，それと同じ列名を持つデータであること）を前提に作られています（引数指定の数を出来るだけ減らすため）．</p></li>
<li><p>**密度推定：**推定手法によって異なる関数を定義しています．</p>
<ul>
<li><p><strong>最尤法</strong>：<strong>mle_rest関数</strong>は，最尤法に基づいてパラメータ推定を行います．この関数は，地点全体の平均的な密度を推定する場合のみに対応しており，シンプルな状況にのみに対応します（滞在時間や密度のパラメータに共変量やランダム効果を含めることはできません）．また，活動時間割合もRowcliffe
et al.（）に基づく点推定値を使っています．</p></li>
<li><p><strong>ベイズ法</strong>：<strong>bayes_rest関数</strong>は，ベイズ法に基づいてパラメータ推定を行います．より発展的な解析を行うのに適しています．確率的プログラミング言語Stanを用いたMCMC法を利用しています．お手持ちのパソコンにRtoolsをインストールして<strong>rstanを使える状態にする必要</strong>があります（rstanのインストールに関しては，他サイトを参考にしてください）．</p></li>
</ul></li>
</ul>
<h2 id="パッケージの入手">パッケージの入手</h2>
<p>　ctrestパッケージは，GitHubからインストールしてください．</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;) </span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#install_github(&quot;norimune/glmmstan&quot;)</span></span></code></pre></div>
<h2 id="データの準備">データの準備</h2>
<p>　解析を始める前に，２つのCSVファイルを準備します．</p>
<ul>
<li><p><strong>撮影データ（detection_data）</strong>：各行に１本の動画情報が入力されたデータシートです．合計で1000回の撮影があった場合は，1000行の表（変数名も含めれば1001行）になります．最低限必要なのは，撮影された地点ID，撮影時刻，動物の種名，各動画における有効範囲の通過回数，滞在時間の測定値<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>，滞在時間測定における打ち切りの有無です．欠損値にはNAを入力します<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>．カメラの点検に複数回赴いた場合，調査回IDの列を入力しておくと，以下で説明するカメラ稼働時間の集計用の関数を使えます．</p></li>
<li><p><strong>カメラ地点データ（station_data）</strong>：各行に各カメラ地点の情報が入力されたデータです．100地点にカメラを設置した場合，100行の表（変数名も含めれば101行）になります．最低限必要なのは，設置点IDです<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>．状況に応じて，設置点の座標，カメラの稼働開始日時（設置日時）や終了日時（回収日，もしくは，最後の撮影日時），各地点の環境共変量などが入力されます．</p></li>
</ul>
<p>　RESTモデルは，対象種が有効撮影範囲を何回通過したかを<strong>すべての動画</strong>に対して計測しなければいけません．一方，REST-RADモデルは，この判定を一部の動画に対して行うだけで密度推定できます<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>．２つのモデルの違いはこの点だけなので，REST用の元データにREST-RADモデルを適用することは可能です（その反対は不可能）．</p>
<p>　以下，パッケージに含まれているexampleデータを使って説明します．パッケージを開いて，使える状態にしましょう．</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(ctrest)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># load_all()</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>detection_data <span class="co"># 撮影データの例</span></span></code></pre></div>
<pre><code>## # A tibble: 1,331 × 7
##    Station DateTime            Term  Species      y  Stay  Cens
##    &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt; &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 ST001   2024-05-07 10:26:00 term1 Surveyor    NA  NA      NA
##  2 ST001   2024-05-08 12:37:33 term1 A            0   1.2     0
##  3 ST001   2024-05-15 17:20:41 term1 A            0   1.8     0
##  4 ST001   2024-05-19 06:14:59 term1 A            0   0.3     0
##  5 ST001   2024-05-20 11:17:50 term1 A            0   1.8     0
##  6 ST001   2024-05-21 05:54:22 term1 A            1   2.7     0
##  7 ST001   2024-05-22 06:00:55 term1 A            2   3.9     0
##  8 ST001   2024-05-22 17:15:18 term1 A            1   1.8     0
##  9 ST001   2024-06-10 12:00:00 term2 Surveyor    NA  NA      NA
## 10 ST001   2024-06-14 13:05:42 term2 A            0   0.5     0
## # ℹ 1,321 more rows</code></pre>
<p>この例では，StationID（地点ID），DateTime（撮影日時），Term（調査回），Species（撮影された動物種名），y（有効範囲に入った回数），Stay（有効範囲内の滞在時間），Cens（滞在時間の打ち切りの有=1，無=0）が入力されています．</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>station_data <span class="co"># カメラ設置点データ</span></span></code></pre></div>
<pre><code>## # A tibble: 100 × 3
##    Station      x1 x2   
##    &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;
##  1 ST001   -0.977  B    
##  2 ST002    1.23   A    
##  3 ST003    0.0338 C    
##  4 ST004   -1.55   A    
##  5 ST005    0.674  B    
##  6 ST006   -0.443  C    
##  7 ST007   -0.530  C    
##  8 ST008    0.506  C    
##  9 ST009   -0.588  C    
## 10 ST010    1.41   C    
## # ℹ 90 more rows</code></pre>
<p>カメラ設置点データには，StationID（地点ID）と２つの共変量（x1とx2）が入力されています<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>．</p>
<p>　以下では，REST用のデータを使って，それぞれのモデルに必要なデータを準備する方法について説明します．</p>
<h2 id="データの前処理">データの<strong>前処理</strong></h2>
<h3 id="データ前処理用の関数">データ前処理用の関数</h3>
<table>
<thead>
<tr class="header">
<th>関数名</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>format_station_data関数</td>
<td>カメラ設置点ごとの撮影枚数の集計</td>
</tr>
<tr class="even">
<td>add_effort関数</td>
<td>カメラ稼働日数の計算</td>
</tr>
<tr class="odd">
<td>format_stay関数</td>
<td>滞在時間・打ち切りの有無の集計</td>
</tr>
<tr class="even">
<td>format_activity関数</td>
<td>撮影時刻のラジアン変換</td>
</tr>
</tbody>
</table>
<p>前処理用の関数一覧</p>
<h3 id="撮影枚数の整理">撮影枚数の整理</h3>
<p>　これら２つの元データに基づいて，REST/REST-RADに必要なデータを準備していきます．</p>
<p>　最初に使うのが，撮影枚数をステーションごとに集計する<strong>format_station_data関数</strong>です．exampleデータでやってみます．</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># REST用データの作成</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>station_data_rest <span class="ot">&lt;-</span> <span class="fu">format_station_data</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data, <span class="co"># 元データ</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">station_data =</span> station_data,     <span class="co"># 元データ</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">col_name_station =</span> <span class="st">&quot;Station&quot;</span>,    <span class="co"># カメラ設置点IDを含む列名</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">col_name_species =</span> <span class="st">&quot;Species&quot;</span>,    <span class="co"># 種名を含む列名</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">col_name_y =</span> <span class="st">&quot;y&quot;</span>,                <span class="co"># 通過回数を含む列名</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;REST&quot;</span>,　                <span class="co"># 推定に利用するモデル名（&quot;REST&quot; or &quot;RAD-REST）</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="at">target_species =</span> <span class="st">&quot;A&quot;</span>　           <span class="co"># 対象種名</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>) </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">head</span>(station_data_rest)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
## # Groups:   Station [6]
##   Station Species     Y      x1 x2   
##   &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;
## 1 ST001   A           5 -0.977  B    
## 2 ST002   A           9  1.23   A    
## 3 ST003   A           1  0.0338 C    
## 4 ST004   A           9 -1.55   A    
## 5 ST005   A           9  0.674  B    
## 6 ST006   A           4 -0.443  C</code></pre>
<h1 id="id_２つのソースデータを地点ごとに統合して必要なデータを準備してくれます上の通りmodel">２つのソースデータを地点ごとに統合して，必要なデータを準備してくれます．上の通り，model</h1>
<p>“REST”とした場合，Y列に有効撮影範囲を通過した合計回数が地点ごとに集計されます．</p>
<p>　今度は，model = “RAD-REST”にしてみましょう．</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>station_data_rad <span class="ot">&lt;-</span> <span class="fu">format_station_data</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data, <span class="co"># 元データ</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">station_data =</span> station_data,     <span class="co"># 元データ</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">col_name_station =</span> <span class="st">&quot;Station&quot;</span>,    <span class="co"># カメラ設置点IDを含む列名</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">col_name_species =</span> <span class="st">&quot;Species&quot;</span>,    <span class="co"># 種名を含む列名</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">col_name_y =</span> <span class="st">&quot;y&quot;</span>,                <span class="co"># 通過回数を含む列名</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;RAD-REST&quot;</span>,　            <span class="co"># 推定に使うモデル名（&quot;REST&quot; or &quot;RAD-REST）</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">target_species =</span> <span class="st">&quot;A&quot;</span>　           <span class="co"># 種名を含む列名</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">head</span>(station_data_rad)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Station     N      x1 x2      y_0   y_1   y_2
##   &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1 ST001      10 -0.977  B         6     3     1
## 2 ST002      11  1.23   A         4     5     2
## 3 ST003       1  0.0338 C         0     1     0
## 4 ST004       9 -1.55   A         4     1     4
## 5 ST005      14  0.674  B         7     5     2
## 6 ST006       5 -0.443  C         2     2     1</code></pre>
<p>Nに「各カメラで撮影された動画総本数」，y_0からy_3は，「あるカメラ地点で通過回数がn回だった動画本数」が入力されています．例えば，1行目のST001というステーションでは，一度も有効撮影範囲を通過しなかった動画が3本，1回だけ通過したのが8本，2回通過したのが0本撮影されたということを意味しています．RAD-RESTモデルを適用するうえでは，すべての動画に対して通過回数を測定する必要は必ずしもない（すなわちyを通過回数で重みづけした合計がNと一致する必要はない）ことに注意してください．今一致しているのは，REST用の元データ（すべての動画を計測対象にしたデータ）を仮に使っているからです．</p>
<h3 id="カメラ稼働期間の追加">カメラ稼働期間の追加</h3>
<p>　先ほど作成したstation_data2には，各カメラが何日稼働していたのかについての情報がありません．<strong>add_effort関数</strong>を使えば，detection_dataの撮影情報から稼働日数を計算して追加することができます．最初の撮影日時を調査開始，最後の撮影日時を調査終了と仮定します．RESTでは，有効範囲の撮影を行うので，最初の撮影日時が稼働開始と一致することは多いはずです．調査終了時に関しても，カメラの電池が残っているものに関しては，手動で撮影を行うことで日時を記録することができます．調査期間途中で稼働しなくなったものは，最後の撮影日までを稼働日数とみなします．調査が複数回にわたる場合，調査回のIDが入力された列をcol_name_term引数にしているすることで合計の稼働日数を計算してくれます．</p>
<p>　add_effort関数のplot引数をTRUEにすると，カメラの稼働の様子を可視化できます．カメラの日時がくるっていることはよくあるので，目で確かめておくとよいでしょう．カメラの台数が多いとカメラ設置点名が重なって見えなくなることが多いです．その場合は，font_size引数に小さな値を入れてください．</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># REST用のデータに追加</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>station_data_comprest <span class="ot">&lt;-</span> <span class="fu">add_effort</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data,            <span class="co"># 元データ</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">station_data_formatted =</span> station_data_rest, <span class="co"># format_station_data関数の返り値</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">col_name_station =</span> <span class="st">&quot;Station&quot;</span>,               <span class="co"># カメラ設置点IDを含む列名</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">col_name_term =</span> <span class="st">&quot;Term&quot;</span>,                     <span class="co"># 調査回ID</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">col_name_datetime =</span> <span class="st">&quot;DateTime&quot;</span>,             <span class="co"># 日時データ</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>,                                <span class="co"># 調査努力を可視化するか</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="at">font_size =</span> <span class="dv">5</span>                               <span class="co"># 可視化した場合の目盛フォント</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">head</span>(station_data_comprest)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   Station Effort Species     Y      x1 x2   
##   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;
## 1 ST001    20.4  A           5 -0.977  B    
## 2 ST002    44.0  A           9  1.23   A    
## 3 ST003     4.89 A           1  0.0338 C    
## 4 ST004    60.3  A           9 -1.55   A    
## 5 ST005    36.9  A           9  0.674  B    
## 6 ST006    32.2  A           4 -0.443  C</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># RAD-REST用のデータに追加（引数指定は上と同じ）</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>station_data_comprad <span class="ot">&lt;-</span> <span class="fu">add_effort</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="at">station_data_formatted =</span> station_data_rad,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">col_name_station =</span> <span class="st">&quot;Station&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">col_name_term =</span> <span class="st">&quot;Term&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="at">col_name_datetime =</span> <span class="st">&quot;DateTime&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># 全データを表示させたい場合</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co"># print(station_data_comprad, n = Inf)</span></span></code></pre></div>
<p>新しくできたEffort列の数値がカメラ稼働時間（日数）を示しています．もし稼働日数が0のものがある場合は，日時の入力などにミスがないかをもう一度確認してください（0だと密度の推定もできません）．</p>
<h3 id="滞在時間の取得">滞在時間の取得</h3>
<p>　滞在時間は，撮影データ（detection_data）に入力されています．RESTでもRAD-RESTでも，滞在時間の測定は必ずしもすべての動画で行う必要はありません．上述の通り，計測しなかった動画については，detection_dataの該当箇所に必ずNAを入力してください．format_stay_data関数で，NAデータを除外します．また，滞在時間に0が入力されていないかを確認します（多くの時間分布は，正の整数のみを確率変数として持ちます）．</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>stay_data <span class="ot">&lt;-</span> <span class="fu">format_stay</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data, <span class="co"># 元データ</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">col_name_station =</span> <span class="st">&quot;Station&quot;</span>,    <span class="co"># カメラ設置点IDを含む列名</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">col_name_species =</span> <span class="st">&quot;Species&quot;</span>,    <span class="co"># 種名を含む列名</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">col_name_stay =</span> <span class="st">&quot;Stay&quot;</span>,          <span class="co"># 滞在時間を含む列名</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">col_name_cens =</span> <span class="st">&quot;Cens&quot;</span>,          <span class="co"># 打ち切りの有無を含む列名</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">target_species =</span> <span class="st">&quot;A&quot;</span>             <span class="co"># 対象種名</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="fu">head</span>(stay_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Station Species  Stay  Cens
##   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 ST001   A         1.2     0
## 2 ST001   A         1.8     0
## 3 ST001   A         0.3     0
## 4 ST001   A         1.8     0
## 5 ST001   A         2.7     0
## 6 ST001   A         3.9     0</code></pre>
<h3 id="撮影時刻の変換">撮影時刻の変換</h3>
<p>　最後に活動時間割合を推定するために撮影時刻をラジアン変換しましょう（他の前処理関数の返り値はtbl形式のデータフレームですが，この関数はベクトルになります）．</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>activity_data <span class="ot">&lt;-</span> <span class="fu">format_activity</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="at">detection_data =</span> detection_data, <span class="co"># 元データ</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">col_name_species =</span> <span class="st">&quot;Species&quot;</span>,    <span class="co"># 種名を含む列名</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">col_name_datetime =</span> <span class="st">&quot;DateTime&quot;</span>,  <span class="co"># 撮影日時を含む列名</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">target_species =</span> <span class="st">&quot;A&quot;</span>             <span class="co"># 対象種名</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">head</span>(activity_data)</span></code></pre></div>
<pre><code>## [1] 3.305484 4.540851 1.636199 2.957668 1.546245 1.574809</code></pre>
<h2 id="最尤推定">最尤推定</h2>
<h3 id="restによる密度推定">RESTによる密度推定</h3>
<p>　mle_rest関数で行います．尤度関数をRのoptim関数で最適化してパラメータ推定しており，標準偏差や信頼区間はヘッセ行列から事後的に計算しています．後に紹介するMCMC法によるベイズ推定に比べて圧倒的に速いです．調査地の平均的な密度をさっと出したいときに使ってください．活動時間割合については，固定カーネル法（Rowcliffe
et al. ）による推定値を定数として入れています．</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">mle_rest</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  station_data_comprest,       <span class="co"># REST用のadd_effort関数の返り値</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  stay_data,                   <span class="co"># format_stay関数の返り値</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  activity_data,               <span class="co"># activity_data関数の返り値</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="at">focal_area =</span> <span class="fl">2.0</span>,            <span class="co"># 有効撮影範囲の面積</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;REST&quot;</span>               <span class="co"># 密度推定に使うモデル名（&quot;REST&quot; or &quot;RAD-REST）</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>## $Density
##              ModelName  Density        SD    Lower    Upper      AIC delta_AIC
## 8   NegBinom-Lognormal 12.64502 1.0011365 10.68280 14.60725 5412.588   0.00000
## 6      NegBinom-Gammma 12.27987 0.9354117 10.44646 14.11327 5477.218  64.62932
## 7     NegBinom-Weibull 12.34944 0.9439784 10.49924 14.19964 5504.735  92.14671
## 4    Poisson-Lognormal 12.32993 0.6295053 11.09610 13.56376 5514.041 101.45238
## 5 NegBinom-Exponential 12.29780 0.9579338 10.42025 14.17535 5539.533 126.94495
## 2       Poisson-Gammma 11.97622 0.5539335 10.89051 13.06193 5578.670 166.08170
## 3      Poisson-Weibull 12.04036 0.5539335 10.94024 13.14048 5606.187 193.59854
## 1  Poisson-Exponential 11.98484 0.5856271 10.83701 13.13267 5640.985 228.39701
## 
## $Stay
## $Stay$Exponential
## [1] 0.284538
## 
## $Stay$Gammma
##     shape      rate 
## 0.3923194 1.3782646 
## 
## $Stay$Weibull
##    shape    scale 
## 1.151017 3.711317 
## 
## $Stay$Lognormal
##   meanlog     sdlog 
## 0.8520860 0.9309364</code></pre>
<h1 id="id_-この関数では撮影枚数についてはポアソン分布または負の二項分布滞在時間については４つの確率分布指数分布ガンマ分布対数正規分布ワイブル分布を想定して全通りの組み合わせ24">　この関数では，撮影枚数についてはポアソン分布または負の二項分布，滞在時間については４つの確率分布（指数分布，ガンマ分布，対数正規分布，ワイブル分布）を想定して，全通りの組み合わせ（2×4</h1>
<p>8通り）で密度推定します．密度の点推定値だけでなく，標準偏差や95%信頼区間，AIC値などを見ることができます．結果の表は，AIC値の小さい順にソートされます．</p>
<h3 id="rad-restによる密度推定">RAD-RESTによる密度推定</h3>
<p>　RAD-RESTに関しても，model = “RAD-REST”とするだけです．</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">mle_rest</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  station_data_comprad, <span class="co"># RAD-REST用のadd_effort関数の返り値</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  stay_data,            <span class="co"># format_stayの返り値</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  activity_data,　　　　<span class="co"># format_activityの返り値</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">focal_area =</span> <span class="fl">2.0</span>,     <span class="co"># 有効撮影範囲の面積</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;RAD-REST&quot;</span>    <span class="co"># 密度推定に使うモデル名</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>## $Density
##              ModelName  Density        SD     Lower    Upper      AIC delta_AIC
## 8   NegBinom-Lognormal 13.09742 0.9366263 11.261633 14.93321 6097.234   0.00000
## 6      NegBinom-Gammma 13.07942 0.9307493 11.255154 14.90369 6159.360  62.12624
## 7     NegBinom-Weibull 11.45105 0.7946609  9.893512 13.00858 6184.784  87.54946
## 4    Poisson-Lognormal 14.34182 0.9313392 12.516390 16.16724 6221.396 124.16163
## 5 NegBinom-Exponential 10.11854 0.7429208  8.662420 11.57467 6239.241 142.00654
## 2       Poisson-Gammma 12.12562 0.6841645 10.784658 13.46658 6277.351 180.11671
## 3      Poisson-Weibull 11.94167 0.6841645 10.660374 13.22297 6304.666 207.43152
## 1  Poisson-Exponential 12.22881 0.7172226 10.823053 13.63457 6340.061 242.82680
## 
## $Stay
## $Stay$Exponential
##           
## 0.3215035 
## 
## $Stay$Gammma
##    shape     rate 
## 0.391224 1.375141 
## 
## $Stay$Weibull
##    shape    scale 
## 1.150112 3.694807 
## 
## $Stay$Lognormal
##   meanlog     sdlog 
## 0.8699632 0.9232136</code></pre>
<p>ベストモデルの密度推定値は，少しRAD-RESTモデルの方が高く出ていますが許容範囲内でしょう．</p>
<h2 id="ベイズ推定">ベイズ推定</h2>
<h3 id="滞在時間のモデル選択">滞在時間のモデル選択</h3>
<p>　MCMCによる密度推定には結構時間がかかるので，先に滞在時間のモデル選択をしておくと良いでしょう．このための関数が，<strong>bayes_stay_selection関数</strong>です．現時点で，指数分布，ガンマ分布，対数正規分布，ワイブル分布の4つの確率分布を利用可能で，評価したモデルのWAIC値を返します．それぞれの確率分布の期待値に固定効果やランダム効果を入れることもできます<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>．この関数の引数を先に示します．</p>
<table>
<thead>
<tr class="header">
<th>引数名</th>
<th>Default値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>formula_stay</strong></td>
<td></td>
<td>滞在時間のモデル式</td>
</tr>
<tr class="even">
<td>station_data</td>
<td></td>
<td>各行に各カメラについての情報（例えばカメラIDや共変量）をもつデータフレーム</td>
</tr>
<tr class="odd">
<td>stay_data</td>
<td></td>
<td>滞在時間・打ち切りの有無をもつデータフレーム</td>
</tr>
<tr class="even">
<td>family</td>
<td>“lognormal”</td>
<td>滞在時間分布の指定．“exponential”，“gamma”，“lognormal”，“weibull”のいずれかを選択</td>
</tr>
<tr class="odd">
<td><strong>local_stay</strong></td>
<td>FALSE</td>
<td>滞在時間の期待値をカメラごとに推定するか（TRUE），グローバルに推定するか（FALSE）の指定</td>
</tr>
<tr class="even">
<td><strong>plot</strong></td>
<td>TRUE</td>
<td>滞在時間の期待値を可視化するか（TRUE），しないか（FALSE）</td>
</tr>
<tr class="odd">
<td>cores</td>
<td>2</td>
<td>計算に利用するコア数</td>
</tr>
<tr class="even">
<td>iter*</td>
<td>3000</td>
<td>iterationの長さ</td>
</tr>
<tr class="odd">
<td>warmup*</td>
<td>iterの半分の長さ</td>
<td>warmupの長さ</td>
</tr>
<tr class="even">
<td>chains*</td>
<td>2</td>
<td>chains数</td>
</tr>
<tr class="odd">
<td>thin*</td>
<td>1</td>
<td>thiningの間隔</td>
</tr>
<tr class="even">
<td><strong>all_comb</strong></td>
<td>FALSE</td>
<td>総当たりのモデルを評価するか（TRUE），しないか（FALSE）</td>
</tr>
</tbody>
</table>
<p><strong>bayes_stay_selection関数の引数一覧．太字の引数については以下で説明．*の意味については，一般的なMCMC法によるベイズ推定に関する書籍やサイトを参考にしてください．</strong></p>
<h4 id="formula_stay引数"><strong>formula_stay引数</strong></h4>
<p>　推定したい滞在時間のモデル式を指定します．モデル式の書き方は，一般化線形混合モデル用のＲのパッケージlme4のlmer関数と同じにしています．あまり複雑なモデルにしても仕方がないので，ランダム効果は切片のみに入れることを想定しており，交互作用などには対応していません．</p>
<p><strong>local_stay引数とplot引数</strong></p>
<p>　この引数は，「どのレベルの滞在時間の期待値を密度推定に利用しようとしているのか」を指定します．滞在時間のモデルに固定効果やランダム効果を入れる場合，滞在時間の期待値には，各カメラの前でのlocalな滞在時間の期待値と，調査地全体のglobalな滞在時間の期待値の２つが存在します．</p>
<p>　どちらを利用するべきかは状況次第です．</p>
<p>　例えば，カメラが動物の行動圏に対して比較的狭い範囲に集中して設置されており，同一個体を複数のカメラが撮影しうる状況では，localな滞在時間は，カメラの前の微小環境を反映したものに過ぎません．この場合，密度推定には，globalな滞在時間の期待値を使った方が良いでしょう<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>（local_stay = FALSE）．</p>
<p>　一方，カメラ間の距離が十分に大きく，それぞれのカメラに撮影されるが別のポピュレーションであると想定される場合には，localな滞在時間は，カメラの前の微小環境だけでなく，各地点での動物の平均的な移動速度も反映している可能性があります．この場合，localな滞在時間の期待値を密度推定に使った方が良いかもしれません（local_stay
= TRUE）．</p>
<p>　<strong>localな滞在時間の期待値を使う場合，その値が現実的な範囲のものであるかを必ず確認する必要があります</strong>．とくに連続型の共変量を入れたモデルでは，共変量側に外れ値がある場合には，滞在時間の方もそれに応じてあり得ない値を示すかもしれません．plot引数をTRUEにしておけば，各カメラでの滞在時間の期待値がどのような値として推定されたのかを可視化してくれます．あまり極端な値がある場合は，その原因となる共変量を外したり，グローバルな推定地の利用を考えたり，何らかの対処をした方がよいです<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>．</p>
<p><strong>all_comb引数</strong></p>
<p>　TRUEにしておくと，formula_stay引数で指定したモデルをフルモデルとして，固定効果・ランダム効果あるなしの総当たりのモデルを作成し，それぞれのモデルのWAIC値を計算します．当然，それなりの時間がかかります．とくに，ランダム効果を入れたモデルだと推定に要する時間は長くなるので注意してください．all_comb
= TRUEでplot =
TRUEとした場合，ベストモデルに基づく期待値が描画されます．</p>
<h4 id="関数の利用">関数の利用</h4>
<p>　カメラ地点IDをランダム効果に，x1を固定効果に入れてそれぞれ入れてみます．</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>model_selection <span class="ot">&lt;-</span> <span class="fu">bayes_stay_selection</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="at">formula_stay =</span> Stay <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x1, <span class="co"># 滞在時間のモデル式</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">station_data =</span> station_data_comprad,  <span class="co"># add_effort関数の返り値</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="at">stay_data =</span> stay_data,        <span class="co"># format_stay関数の返り値</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;lognormal&quot;</span>,         <span class="co"># 滞在時間分布</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">local_stay =</span> <span class="cn">TRUE</span>,            <span class="co"># 上で説明</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>,                  <span class="co"># 滞在時間の期待値を可視化するか</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">3</span>,                    <span class="co"># 計算に利用するコア数</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">3000</span>,                  <span class="co"># iteration数</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="cn">NULL</span>,                <span class="co"># warmup数</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">3</span>,                   <span class="co"># チェーン数</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,                     <span class="co"># thinningの間隔</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  <span class="at">all_comb =</span> <span class="cn">TRUE</span>               <span class="co"># 上で説明</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Stay~1 [lognormal] 
## Now compiling!
## 
## MCMC sampling start.
## Stay~1 + x1 [lognormal] 
## Now compiling!

## recompiling to avoid crashing R session

## 
## MCMC sampling start.</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>model_selection</span></code></pre></div>
<pre><code>## $result
##           Model    Family     lppd p_waic    WAIC
## 1      Stay ~ 1 lognormal -2523.53   1.97 5051.00
## 2 Stay ~ 1 + x1 lognormal -2523.54   2.98 5053.04
## 
## $plot</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>WAIC値を比較すると，ほとんど差がありません．このような場合はシンプルなモデルを選択すればよいでしょう．他の確率分布を試したい場合は，family引数で指定してください．</p>
<h3 id="密度推定のための関数">密度推定のための関数</h3>
<p>　滞在時間のモデル選択が出来たらいよいよ密度推定です．</p>
<p>　密度をベイズ推定する関数は，<strong>bayes_rest関数</strong>です．以下のように，必要な変数を指定するだけで密度が推定できます．まず，関数の全引数を示します．</p>
<table>
<thead>
<tr class="header">
<th>引数名</th>
<th>Default値</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>formula_stay</td>
<td></td>
<td>滞在時間のモデル式</td>
</tr>
<tr class="even">
<td>formula_density</td>
<td></td>
<td>密度のモデル式</td>
</tr>
<tr class="odd">
<td>station_data_complete</td>
<td></td>
<td>add_effort関数の返り値</td>
</tr>
<tr class="even">
<td>stay_data</td>
<td></td>
<td>format_stay関数の返り値</td>
</tr>
<tr class="odd">
<td>activity_data</td>
<td></td>
<td>format_activity関数の返り値</td>
</tr>
<tr class="even">
<td><strong>activity_model</strong></td>
<td>“kernel”</td>
<td>活動時間割合の推定手法，“kernel”または”mixed”</td>
</tr>
<tr class="odd">
<td><strong>K</strong></td>
<td>5</td>
<td>活動時間割合の推定にvon Mises混合分布を用いる場合（activity_model =
“mixed”）の場合の混合数．</td>
</tr>
<tr class="even">
<td><strong>bw_adj</strong></td>
<td>1.5</td>
<td>活動時間割合の推定に固定カーネル法を用いる場合のバンド幅の調整</td>
</tr>
<tr class="odd">
<td>stay_family</td>
<td>“lognormal”</td>
<td>滞在時間分布の指定．“exponential”，“gamma”，“lognormal”，“weibull”のいずれかを選択</td>
</tr>
<tr class="even">
<td>local_stay</td>
<td>FALSE</td>
<td>滞在時間の期待値をカメラごとに推定するか（TRUE），グローバルに推定するか（FALSE）の指定．詳細は，bayes_stay_selection関数のところで説明．</td>
</tr>
<tr class="odd">
<td>focal_area</td>
<td></td>
<td>滞在時間の期待値をカメラごとに推定するか（TRUE），グローバルに推定するか（FALSE）の指定</td>
</tr>
<tr class="even">
<td>cores*</td>
<td>2</td>
<td>計算に利用するコア数</td>
</tr>
<tr class="odd">
<td>iter*</td>
<td>2000</td>
<td>iterationの長さ</td>
</tr>
<tr class="even">
<td>warmup*</td>
<td>iterの半分の長さ</td>
<td>warmupの長さ</td>
</tr>
<tr class="odd">
<td>chains*</td>
<td>2</td>
<td>chains数</td>
</tr>
<tr class="even">
<td>thin*</td>
<td>1</td>
<td>thiningの間隔</td>
</tr>
<tr class="odd">
<td>model</td>
<td>“REST”</td>
<td>密度推定モデルの選択．“REST”または”RAD-REST”のいずれか</td>
</tr>
</tbody>
</table>
<p><strong>bayes_rest関数の引数一覧．太字の引数については以下で説明．*の意味については，一般的なMCMC法によるベイズ推定に関する書籍やサイトを参考にしてください．</strong></p>
<h4 id="活動時間割合に関わる引数">活動時間割合に関わる引数</h4>
<p>　活動時間割合の推定方法を指定するのがactivity_moel引数です．２つの方法が利用可能です．</p>
<p>　**activity =
“kernel”**とした場合，固定カーネル法による推定を行います．詳細は，Rowcliffe
et
al. (2014)を参照してください．この推定方法を用いる場合，バンド幅の調整方法を指定するbw_adj引数も同時に指定できます．デフォルト値は，Rowcliffe
et
al. (2014)の論文のシミュレーション結果に基づいて1.5にしています．特別な事情がない限り，デフォルト値のままでよいでしょう．</p>
<p>　**activity = “mixed”**とした場合，撮影時間をvon
Mises混合分布に従う確率変数であると考えます．混合分布では，何個の確率分布を混ぜ合わせるかが問題になります．それを指定するのがK引数です．Kのデフォルト値は5にしています．経験的には，大体この値で対処できるようです．Kの値を大きくすればその分だけ推定に要する時間が長くなります．あまり小さいと，うまく活動レベルの変動にフィットしなくなります<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>．</p>
<p>　２つの推定手法にはいくつかの点で顕著な違いがあります．</p>
<p>　１つ目の違いは，不確実性の評価に関してです．混合von
Mises分布を利用した方法では，他の変数と同様にパラメータのベイズ推定を行います．活動時間割合も点推定値ではなく，不確実性を含んだ値として扱われます．一方で，固定カーネル法の方はRowcliffe
et
al. (2014)が作成したactivityパッケージの点推定値をそのまま定数として入れています．したがって，密度の見た目上の推定精度は，固定カーネル法を利用した方が良くなります．</p>
<p>　２つ目は，推定に要する時間の違いです．一般に混合分布のパラメータ推定には非常に時間がかかります．MCMCで混合分布を解くのは結構しんどいことと，Stanのvon
Mises分布の確率密度関数（von_mises_lpdf）がベクトル化に対応していないことが原因です．推定結果が出るまでに数十分はかかると思ってください．一方，カーネル法は定数として入れるので，それに比べるとはるかに速いです（最尤推定よりは遅い）．</p>
<p>　３つ目は，推定のバイアスに関する違いです．Rowcliffe et
al. (2014)は，von
Mises混合分布を利用した方法は，サンプルサイズが小さい場合（50未満），活動時間割合を過小評価する（密度は過大評価される）傾向があると指摘しています．同様の傾向を私も確認しています．あまり気にする必要はありませんが，推定値を比較する場合には少し注意が必要です．</p>
<p>　これらの違いを踏まえたうえで，どちらの方法を使うかを判断してください．活動時間割合のパラメータだけ定数で入れるのはなんとなく気持ち悪いので混合分布を実装しましたが<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>，必ずしもお勧めしません．推定にかかる時間を考えると，少なくとも試行錯誤の段階では固定カーネル法の方が良いでしょう．そして解析の最終段階で．混合分布の利用を考えてみるのも一つの手です．いずれにせよ，活動時間割合の推定は，REST/RAD-RESTを含む，無標識個体群のための密度推定手法の最大の弱点です．どちらの方法も抱えている弱点（仮定の強さ）は同じなので，こだわりすぎる必要はありません．</p>
<h4 id="local_stay引数">local_stay引数</h4>
<h1 id="id_-引数の意味はbayes_stay_selection関数の場合と同じです滞在時間に共変量を入れてグローバルな滞在時間の期待値を使って密度推定を行う場合local_stay">　引数の意味は，bayes_stay_selection関数の場合と同じです．滞在時間に共変量を入れて，グローバルな滞在時間の期待値を使って密度推定を行う場合，local_stay</h1>
<p>TRUEとします．例えば，カメラ設置点の開空度や獣道であるかどうかなどを入れることが考えられます．これらを考慮することで，グローバルな滞在時間の推定精度も向上できることがあります<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>．</p>
<h3 id="restによる密度推定-1">RESTによる密度推定</h3>
<p>　RESTによる密度推定は，以下のように引数指定します．この例では，密度に共変量を与えています．与えないモデルとどちらが汎化（予測）性能が高いかは，関数の返り値の一つであるWAIC値で比較してください．推定後は，事後分布が収束しているかをRhat値やtraceplotで必ず確認してください．</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>fitstan <span class="ot">&lt;-</span> <span class="fu">bayes_rest</span>(</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="at">formula_stay =</span> Stay <span class="sc">~</span> <span class="dv">1</span>,     <span class="co"># 滞在時間のモデル式</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="at">formula_density =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x2,　<span class="co"># 密度のモデル式</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  station_data_comprest,       <span class="co"># add_effort関数の返り値</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  stay_data,                   <span class="co"># format_stay関数の返り値</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  activity_data,　       　　　<span class="co"># format_activityの返り値</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="at">activity_model =</span> <span class="st">&quot;kernel&quot;</span>,   <span class="co"># 活動時間割合の推定方法</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="at">local_stay =</span> <span class="cn">FALSE</span>,          <span class="co"># bayes_stay_selection関数で説明</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="at">stay_family =</span> <span class="st">&quot;lognormal&quot;</span>,   <span class="co"># 滞在時間分布</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="at">focal_area =</span> <span class="fl">2.0</span>,            <span class="co"># 有効撮影範囲の面積</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;REST&quot;</span>               <span class="co"># 密度推定に使うモデル名</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## REST Stay~1 density~1 + x2 [lognormal] 
## Now compiling!
## 
## MCMC sampling start.
## 
## lppd = -2726.6102
## pWAIC = 44.8575
## WAIC = 5542.9353</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;expected_global_density&quot;</span>)   <span class="co"># 全体での密度</span></span></code></pre></div>
<pre><code>##    mean se_mean      sd    2.5%     25%     50%     75%   97.5%   n_eff    Rhat 
##   13.80    0.02    1.10   11.80   13.02   13.74   14.51   16.11 2473.89    1.00</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># attr(fitstan,&quot;expected_local_density&quot;)  # カメラごとの密度</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;mean_stay&quot;</span>)                 <span class="co"># 平均滞在時間</span></span></code></pre></div>
<pre><code>##    mean se_mean      sd    2.5%     25%     50%     75%   97.5%   n_eff    Rhat 
##    3.92    0.00    0.14    3.66    3.82    3.91    4.01    4.20 2275.47    1.00</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;WAIC&quot;</span>)                      <span class="co"># WAIC値</span></span></code></pre></div>
<pre><code>##        WAIC        lppd      p_waic 
##  5542.93527 -2726.61017    44.85746</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># 全体密度のトレースプロット</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">traceplot</span>(fitstan, <span class="st">&quot;expected_global_density&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h3 id="rad-restによる密度推定-1">RAD-RESTによる密度推定</h3>
<p>　RAD-RESTによる密度推定の例は以下の通りです．RESTの場合と同じ状況のコード例を示します．　</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>fitstan <span class="ot">&lt;-</span> <span class="fu">bayes_rest</span>(</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="at">formula_stay =</span> Stay <span class="sc">~</span> <span class="dv">1</span>,     <span class="co"># 滞在時間のモデル式</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="at">formula_density =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x2,　<span class="co"># 密度のモデル式</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  station_data_comprad,        <span class="co"># add_effort関数の返り値</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  stay_data,                   <span class="co"># format_stay関数の返り値</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  activity_data,               <span class="co"># format_activityの返り値</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  <span class="at">activity_model =</span> <span class="st">&quot;kernel&quot;</span>,   <span class="co"># 活動時間割合の推定方法</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  <span class="at">local_stay =</span> <span class="cn">FALSE</span>,          <span class="co"># bayes_stay_selection関数で説明</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  <span class="at">stay_family =</span> <span class="st">&quot;lognormal&quot;</span>,   <span class="co"># 滞在時間分布</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  <span class="at">focal_area =</span> <span class="fl">2.0</span>,            <span class="co"># 有効撮影範囲の面積</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;RAD-REST&quot;</span>           <span class="co"># 密度推定に使うモデル名</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## RAD-REST Stay~1 density~1 + x2 [lognormal] 
## Now compiling!
## 
## MCMC sampling start.
## 
## lppd = -2753.6368
## pWAIC = 45.2008
## WAIC = 5597.6753</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;expected_global_density&quot;</span>)  <span class="co"># 全体での密度</span></span></code></pre></div>
<pre><code>##    mean se_mean      sd    2.5%     25%     50%     75%   97.5%   n_eff    Rhat 
##   13.58    0.03    1.00   11.73   12.89   13.54   14.22   15.63 1209.51    1.00</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># attr(fitstan,&quot;expected_local_density&quot;) # カメラごとの密度</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;mean_density&quot;</span>)             <span class="co"># 平均滞在時間</span></span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">attr</span>(fitstan,<span class="st">&quot;WAIC&quot;</span>)                     <span class="co"># WAIC値</span></span></code></pre></div>
<pre><code>##       WAIC       lppd     p_waic 
##  5597.6753 -2753.6368    45.2008</code></pre>
<p>　</p>
<p>　</p>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>複数の動画にまたがって滞在した場合は，1本目の動画に滞在時間の合計値を入力するか，１本目の滞在時間を入力して，打ち切りの列に1（=打ち切り有）と入力するか，のどちらかです．また，１本の動画で複数の通過がある場合は，どれか１回の滞在時間を入力します．<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>RではNAはNot
Availableの意味する特殊な予約語です．これに限らず欠損データは，半角英数字でNAとしてください．<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>設置点IDだけなら，撮影データから取得してもいいですが，撮影のなかったカメラ地点の情報をうっかり失う可能性があります．この点，十分気を付けてください．<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>REST-RADを使う上で，何本の動画を測定対象にするべきかについては，Nakashima
et al. （）を参考にしてください．<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>滞在時間に共変量を入れたい場合も，環境変数の値はstation_dataに入力してください．<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>ランダム効果を入れた場合のWAIC値は，現時点では条件付き尤度に基づくconditonal
WAIC値です．<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>狭い調査地であったとしても，調査地内が大きく２つの環境に区分される場合などは，この限りではありません．<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>現時点で一番簡単な解決策は，滞在時間の共変量はカテゴリカル変数に限るというものです．現在，ディレクレ過程混合モデルの利用も検討しており，将来的にはこのパッケージで利用できるようにしようと思っています．<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>混合数もWAIC値に基づいて決めることは可能ですが，今のところこのパッケージでは実装していません．<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>因みにWearn et
al. 2022は，活動時間割合をこれとは別の方法で行っていますが，これはインチキなので真似しないでください．<a href="#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>この場合，滞在時間の期待値は，exp(切片 + 係数 *
共変量の期待値)で与えています．共変量の期待値の不確実性は考慮していません．<a href="#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</body>
</html>
